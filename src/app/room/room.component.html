<!-- <story *ngIf="room.story" [room]="room" [user]="user"></story>
  <p>room works!{{room.id}}</p>
 (ionInfinite)="chatLoad($event,'top')"
-->
<div id="topmsg" class="msg"><span *ngIf="mentionTop" (click)="mentionClick('top')" class="mention">メンション↑{{mentionTop}}件</span></div>
<ion-content id="chatscontent" #chatscontent [scrollEvents]="true" (ionScroll)="onScroll($event)" (ionScrollEnd)="onScrollEnd($event)">
  <ion-infinite-scroll #top position="top" threshold="10px" (ionInfinite)="chatLoad($event,'top')">
    <ion-infinite-scroll-content loadingSpinner="bubbles">
    </ion-infinite-scroll-content>
  </ion-infinite-scroll>
  <div><span style="color:lightgrey">{{topMsg}}</span></div>

  <!--<span *ngIf="mentionTop">メンション↑{{mentionTop}}件</span>-->
  <ion-list>
    <ion-item class="chat" *ngFor="let chat of chats.reverse()" [class.readed]="chat.readed">
      <span style="display:none;">{{chat.upd.toDate() | date:'MMM d, y, H:mm:ss:SSS'}}</span>
      <ion-avatar item-start>
        <ion-img [src]="chat.avatar"></ion-img>
      </ion-avatar>
      <div><span class="chatna">{{chat.na}}</span>
        <span class="chatdate">{{chat.upd.toDate() | date:'short'}}</span>
        <div [innerHtml]="chat.txt | safe: 'html'"></div>
      </div>
    </ion-item>
  </ion-list>

  <!-->-->

  <div (click)="btmClick()"><span style="color:lightgrey">{{btmMsg}}</span></div>
  <ion-infinite-scroll #btm position="bottom" threshold="10px" (ionInfinite)="chatLoad($event,'btm')">
    <ion-infinite-scroll-content loadingSpinner="bubbles">
    </ion-infinite-scroll-content>
  </ion-infinite-scroll>
</ion-content>
<div id="btmmsg" class="msg"><span class="mention" *ngIf="mentionBtm" (click)="mentionClick('btm')">メンション↓{{mentionBtm}}件</span><span
    *ngIf="data.newChat">新着メッセージ↓</span></div>